<h1>リクエスト詳細</h1>

<p>依頼者: <%= @request.user.name %></p>
<p>撮影希望日: <%= @request.shooting_date %></p>
<p>撮影希望地: <%= @request.shooting_location %></p>
<p>予算: <%= @request.budget %></p>
<p>コメント（備考）: <%= @request.comment %></p>
<p>住所: <%= @request.address %></p>
<p>電話番号: <%= @request.phone_number %></p>
<p>ステータス: <%= @request.status %></p>




<%= link_to '一覧に戻る', requests_path %>

<% if @request.status == 'accepted' %>
  <h2>メッセージ</h2>

  <% @messages.each do |message| %>
    <p>
      <%= message.user.name %>: <%= message.body %>
    </p>
  <% end %>

  <%= form_with(model: [ @request, @message ]) do |form| %>
    <div class="field">
      <%= form.label :body %>
      <%= form.text_field :body %>
    </div>

    <div class="actions">
      <%= form.submit 'メッセージを送信' %>
    </div>
  <% end %>
<% end %>

<!-- TODO:↓確認ダイアログの表示方法がrails7だと変わっているようなので、後ほど要修正 -->
<% if @request.can_be_accepted_by?(current_photographer) %>
  <%= button_to '受け入れる', accept_request_path(@request),
   form:{data:{turbo_confirm:"リクエストを受け入れますか？"}} %>
<% end %>
<% if @request.can_be_declined_by?(current_photographer) %>
  <%= button_to '拒否する', decline_request_path(@request),
   form:{data:{turbo_confirm:"リクエストを拒否しますか？"}} %>
<% end %>
<% if @request.can_be_completed_by?(current_photographer) %>
  <%= button_to '完了する', complete_request_path(@request),
  form:{data:{turbo_confirm:"完了してよろしいですか？"}} %>
<% end %>

